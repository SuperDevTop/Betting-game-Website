!function(e,o){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e.Tour=o(t)}):"object"==typeof exports?module.exports=o(require("jquery")):e.Tour=o(e.jQuery)}(window,function(b){var w,i,r;function t(t){var e;try{e=window.localStorage}catch(t){e=!1}if(r={prevButton:"Prev",nextButton:"Next",pauseButton:"Pause",resumeButton:"Resume",endTourButton:"End Tour"},this._options=b.extend(!0,{name:"tour",steps:[],container:"body",autoscroll:!0,keyboard:!0,storage:e,debug:!1,backdrop:!1,backdropContainer:"body",backdropPadding:0,redirect:!0,orphan:!1,duration:!1,delay:!1,basePath:"",template:null,localization:{buttonTexts:r},framework:"bootstrap3",sanitizeWhitelist:[],sanitizeFunction:null,showProgressBar:!0,showProgressText:!0,getProgressBarHTML:null,getProgressTextHTML:null,afterSetState:function(t,e){},afterGetState:function(t,e){},afterRemoveState:function(t){},onStart:function(t){},onEnd:function(t){},onShow:function(t){},onShown:function(t){},onHide:function(t){},onHidden:function(t){},onNext:function(t){},onPrev:function(t){},onPause:function(t,e){},onResume:function(t,e){},onRedirectError:function(t){},onElementUnavailable:null,onPreviouslyEnded:null,onModalHidden:null},t),"bootstrap3"!==this._options.framework&&"bootstrap4"!==this._options.framework)throw this._debug("Invalid framework specified: "+this._options.framework),"Bootstrap Tourist: Invalid framework specified";if(i={bootstrap3:'<div class="popover" role="tooltip"> <div class="arrow"></div> <h3 class="popover-title"></h3> <div class="popover-content"></div> <div class="popover-navigation"> <div class="btn-group"> <button class="btn btn-sm btn-default" data-role="prev">&laquo; '+this._options.localization.buttonTexts.prevButton+'</button> <button class="btn btn-sm btn-default" data-role="next">'+this._options.localization.buttonTexts.nextButton+' &raquo;</button> <button class="btn btn-sm btn-default" data-role="pause-resume" data-pause-text="'+this._options.localization.buttonTexts.pauseButton+'" data-resume-text="'+this._options.localization.buttonTexts.resumeButton+'">'+this._options.localization.buttonTexts.pauseButton+'</button> </div> <button class="btn btn-sm btn-default" data-role="end">'+this._options.localization.buttonTexts.endTourButton+"</button> </div> </div>",bootstrap4:'<div class="popover" role="tooltip"> <div class="arrow"></div> <h3 class="popover-header"></h3> <div class="popover-body"></div> <div class="popover-navigation"> <div class="btn-group"> <button class="btn btn-sm btn-outline-secondary" data-role="prev">&laquo; '+this._options.localization.buttonTexts.prevButton+'</button> <button class="btn btn-sm btn-outline-secondary" data-role="next">'+this._options.localization.buttonTexts.nextButton+' &raquo;</button> <button class="btn btn-sm btn-outline-secondary" data-role="pause-resume" data-pause-text="'+this._options.localization.buttonTexts.pauseButton+'" data-resume-text="'+this._options.localization.buttonTexts.resumeButton+'">'+this._options.localization.buttonTexts.pauseButton+'</button> </div> <button class="btn btn-sm btn-outline-secondary" data-role="end">'+this._options.localization.buttonTexts.endTourButton+"</button> </div> </div>"},null===this._options.template?null!=i[this._options.framework]&&null!=i[this._options.framework]?(this._options.template=i[this._options.framework],this._debug("Using framework template: "+this._options.framework)):this._debug("Warning: "+this._options.framework+" specified for template (no template option set), but framework is unknown. Tour will not work!"):this._debug("Using custom template"),"function"==typeof this._options.sanitizeFunction)this._debug("Using custom sanitize function in place of bootstrap - security implications, be careful");else{this._options.sanitizeFunction=null,this._debug("Extending Bootstrap sanitize options");var o=[];"bootstrap4"==this._options.framework&&void 0!==b.fn.popover.Constructor.Default.whiteList&&(o=b.fn.popover.Constructor.Default.whiteList),"bootstrap3"==this._options.framework&&void 0!==b.fn.popover.Constructor.DEFAULTS.whiteList&&(o=b.fn.popover.Constructor.DEFAULTS.whiteList);var n=b.extend(!0,{},o);b.each({button:["data-role","style"],img:["style"],div:["style"]},function(t,e){null==n[t]&&(n[t]=[]),b.merge(n[t],e)}),b.each(this._options.sanitizeWhitelist,function(t,e){null==n[t]&&(n[t]=[]),b.merge(n[t],e)}),this._options.sanitizeWhitelist=n}return this._current=null,this.backdrops=[],this}return w=window.document,t.prototype.addSteps=function(t){var e,o,n;for(e=0,o=t.length;e<o;e++)n=t[e],this.addStep(n);return this},t.prototype.addStep=function(t){return this._options.steps.push(t),this},t.prototype.getStepCount=function(){return this._options.steps.length},t.prototype.getStep=function(t){if(null!=this._options.steps[t])return"function"==typeof this._options.steps[t].element&&(this._options.steps[t].element=this._options.steps[t].element()),this._options.steps[t]=b.extend(!0,{id:"step-"+t,path:"",host:"",placement:"right",title:"",content:"<p></p>",next:t===this._options.steps.length-1?-1:t+1,prev:t-1,animation:!0,container:this._options.container,autoscroll:this._options.autoscroll,backdrop:this._options.backdrop,backdropContainer:this._options.backdropContainer,backdropPadding:this._options.backdropPadding,redirect:this._options.redirect,reflexElement:this._options.steps[t].element,preventInteraction:!1,orphan:this._options.orphan,duration:this._options.duration,delay:this._options.delay,template:this._options.template,showProgressBar:this._options.showProgressBar,showProgressText:this._options.showProgressText,getProgressBarHTML:this._options.getProgressBarHTML,getProgressTextHTML:this._options.getProgressTextHTML,onShow:this._options.onShow,onShown:this._options.onShown,onHide:this._options.onHide,onHidden:this._options.onHidden,onNext:this._options.onNext,onPrev:this._options.onPrev,onPause:this._options.onPause,onResume:this._options.onResume,onRedirectError:this._options.onRedirectError,onElementUnavailable:this._options.onElementUnavailable,onModalHidden:this._options.onModalHidden,internalFlags:{elementModal:null,elementModalOriginal:null,elementBootstrapSelectpicker:null}},this._options.steps[t]),this._options.steps[t]},t.prototype._setStepFlag=function(t,e,o){null!=this._options.steps[t]&&(this._options.steps[t].internalFlags[e]=o)},t.prototype._getStepFlag=function(t,e){if(null!=this._options.steps[t])return this._options.steps[t].internalFlags[e]},t.prototype.init=function(){console.log("You should remove Tour.init() from your code. It's not required with Bootstrap Tourist")},t.prototype.start=function(){if(this.ended())return null!=this._options.onPreviouslyEnded&&"function"==typeof this._options.onPreviouslyEnded?(this._debug("Tour previously ended, exiting. Call tour.restart() to force restart. Firing onPreviouslyEnded()"),this._options.onPreviouslyEnded(this)):this._debug("Tour previously ended, exiting. Call tour.restart() to force restart"),this;this.setCurrentStep(),this._initMouseNavigation(),this._initKeyboardNavigation();var t=this;b(window).on("resize.tour-"+t._options.name,function(){t.reshowCurrentStep()});var e=this._makePromise(null!=this._options.onStart?this._options.onStart(this):void 0);return this._callOnPromiseDone(e,this.showStep,this._current),this},t.prototype.next=function(){var t;return t=this.hideStep(),this._callOnPromiseDone(t,this._showNextStep)},t.prototype.prev=function(){var t;return t=this.hideStep(),this._callOnPromiseDone(t,this._showPrevStep)},t.prototype.goTo=function(t){var e;return this._debug("goTo step "+t),e=this.hideStep(),this._callOnPromiseDone(e,this.showStep,t)},t.prototype.end=function(){var t,e,o;return t=function(t){if(b(w).off("click.tour-"+o._options.name),b(w).off("keyup.tour-"+o._options.name),b(window).off("resize.tour-"+o._options.name),b(window).off("scroll.tour-"+o._options.name),o._setState("end","yes"),o._clearTimer(),null!=o._options.onEnd)return o._options.onEnd(o)},e=(o=this).hideStep(),this._callOnPromiseDone(e,t)},t.prototype.ended=function(){return"yes"==this._getState("end")},t.prototype.restart=function(){return this._removeState("current_step"),this._removeState("end"),this._removeState("redirect_to"),this.start()},t.prototype.pause=function(){var t;return(t=this.getStep(this._current))&&t.duration?(this._paused=!0,this._duration-=(new Date).getTime()-this._start,window.clearTimeout(this._timer),this._debug("Paused/Stopped step "+(this._current+1)+" timer ("+this._duration+" remaining)."),null!=t.onPause?t.onPause(this,this._duration):void 0):this},t.prototype.resume=function(){var t,e;return(t=this.getStep(this._current))&&t.duration?(this._paused=!1,this._start=(new Date).getTime(),this._duration=this._duration||t.duration,this._timer=window.setTimeout((e=this,function(){return e._isLast()?e.next():e.end()}),this._duration),this._debug("Started step "+(this._current+1)+" timer with duration "+this._duration),null!=t.onResume&&this._duration!==t.duration?t.onResume(this,this._duration):void 0):this},t.prototype.reshowCurrentStep=function(){var t;return this._debug("Reshowing current step "+this.getCurrentStepIndex()),t=this.hideStep(),this._callOnPromiseDone(t,this.showStep,this._current)},t.prototype.hideStep=function(){var t,e,o,n,i,r;if(n=this.getStep(this.getCurrentStepIndex()))return this._clearTimer(),o=this._makePromise(null!=n.onHide?n.onHide(this,this.getCurrentStepIndex()):void 0),i=this,e=function(t){var e;(e=b(n.element)).data("bs.popover")||e.data("popover")||(e=b("body")),"bootstrap3"==i._options.framework&&e.popover("destroy"),"bootstrap4"==i._options.framework&&e.popover("dispose"),e.removeClass("tour-"+i._options.name+"-element tour-"+i._options.name+"-"+i.getCurrentStepIndex()+"-element").removeData("bs.popover"),n.reflex&&b(n.reflexElement).removeClass("tour-step-element-reflex").off(i._reflexEvent(n.reflex)+".tour-"+i._options.name),i._hideOverlayElement(n),i._unfixBootstrapSelectPickerZindex(n);var o=i._getStepFlag(i.getCurrentStepIndex(),"elementModalOriginal");if(null!=o&&(i._setStepFlag(i.getCurrentStepIndex(),"elementModalOriginal",null),n.element=o),null!=n.onHidden)return n.onHidden(i)},t=n.delay.hide||n.delay,"[object Number]"==={}.toString.call(t)&&0<t?(this._debug("Wait "+t+" milliseconds to hide the step "+(this._current+1)),window.setTimeout((r=this,function(){return r._callOnPromiseDone(o,e)}),t)):this._callOnPromiseDone(o,e),o},t.prototype.showStep=function(e){var t,o,n,i,r,s,a;if(this.ended())return this._debug("Tour ended, showStep prevented."),null!=this._options.onEnd&&this._options.onEnd(this),this;if((s=this.getStep(e))&&(r=e<this._current,o=this._makePromise(null!=s.onShow?s.onShow(this,e):void 0),this.setCurrentStep(e),t=function(){switch({}.toString.call(s.path)){case"[object Function]":return s.path();case"[object String]":return this._options.basePath+s.path;default:return s.path}}.call(this),!s.redirect||!this._isRedirect(s.host,t,w.location)||(this._redirect(s,e,t),this._isJustPathHashDifferent(s.host,t,w.location)))){if($modalObject=null,!1===s.orphan&&(b(s.element).hasClass("modal")||b(s.element).data("bs.modal"))&&($modalObject=b(s.element),this._setStepFlag(this.getCurrentStepIndex(),"elementModalOriginal",s.element),s.element=b(s.element).find(".modal-content:first")),a=b(s.element),null===$modalObject&&a.parents(".modal:first").length&&($modalObject=a.parents(".modal:first")),$modalObject&&0<$modalObject.length){this._debug("Modal identified, onModalHidden callback available"),this._setStepFlag(e,"elementModal",$modalObject);var p=(l=this,u=$modalObject,function(){if(l._debug("Modal close triggered"),"function"==typeof s.onModalHidden){var t;if(!1===(t=s.onModalHidden(l,e)))return void l._debug("onModalHidden returned exactly false, tour step unchanged");if(Number.isInteger(t))return l._debug("onModalHidden returned int, tour moving to step "+t+1),u.off("hidden.bs.modal",p),l.goTo(t);l._debug("onModalHidden did not return false or int, continuing tour")}return u.off("hidden.bs.modal",p),l._isLast()?l.next():l.end()});$modalObject.off("hidden.bs.modal",p).on("hidden.bs.modal",p)}var l,u,h,d;if(h=this,i=function(t){if(h._isOrphan(s)){if(!1===s.orphan)return h._debug("Skip the orphan step "+(h._current+1)+".\nOrphan option is false and the element "+s.element+" does not exist or is hidden."),"function"==typeof s.onElementUnavailable&&(h._debug("Calling onElementUnavailable callback"),s.onElementUnavailable(h,h._current)),void(r?h._showPrevStep(!0):h._showNextStep(!0));h._debug("Show the orphan step "+(h._current+1)+". Orphans option is true.")}if(s.autoscroll&&!h._isOrphan(s)?h._scrollIntoView(e):h._showPopoverAndOverlay(e),s.duration)return h.resume()},n=s.delay.show||s.delay,"[object Number]"==={}.toString.call(n)&&0<n)this._debug("Wait "+n+" milliseconds to show the step "+(this._current+1)),window.setTimeout((d=this,function(){return d._callOnPromiseDone(o,i)}),n);else if(s.delayOnElement){function c(){return"function"==typeof s.delayOnElement.delayElement?s.delayOnElement.delayElement():"element"==s.delayOnElement.delayElement?b(s.element):b(s.delayOnElement.delayElement)}var f=null,_=null,m=this,g=0<(f=c()).length?f[0].tagName:s.delayOnElement.delayElement,v=s.delayOnElement.maxDelay?s.delayOnElement.maxDelay:2e3;this._debug("Wait for element "+g+" visible or max "+v+" milliseconds to show the step "+(this._current+1)),_=window.setInterval(function(){if(m._debug("Wait for element "+g+": checking..."),0===f.length&&(f=c()),f.is(":visible"))return m._debug("Wait for element "+g+": found, showing step"),window.clearInterval(_),_=null,m._callOnPromiseDone(o,i)},250),v<250&&(v=251),window.setTimeout(function(){if(_)return m._debug("Wait for element "+g+": max timeout reached without element found"),window.clearInterval(_),m._callOnPromiseDone(o,i)},v)}else this._callOnPromiseDone(o,i);return o}},t.prototype.getCurrentStepIndex=function(){return this._current},t.prototype.setCurrentStep=function(t){return null!=t?(this._current=t,this._setState("current_step",t)):(this._current=this._getState("current_step"),this._current=null===this._current?0:parseInt(this._current,10)),this},t.prototype._setState=function(t,e){var o;if(this._options.storage){o=this._options.name+"_"+t;try{this._options.storage.setItem(o,e)}catch(t){t.code===DOMException.QUOTA_EXCEEDED_ERR&&this._debug("LocalStorage quota exceeded. State storage failed.")}return this._options.afterSetState(o,e)}return null==this._state&&(this._state={}),this._state[t]=e},t.prototype._removeState=function(t){var e;return this._options.storage?(e=this._options.name+"_"+t,this._options.storage.removeItem(e),this._options.afterRemoveState(e)):null!=this._state?delete this._state[t]:void 0},t.prototype._getState=function(t){var e,o;return this._options.storage?(e=this._options.name+"_"+t,o=this._options.storage.getItem(e)):null!=this._state&&(o=this._state[t]),void 0!==o&&"null"!==o||(o=null),this._options.afterGetState(t,o),o},t.prototype._showNextStep=function(t){var e,o,n,i;if(t=t||!1,o=function(t){return i.showStep(i._current+1)},e=void 0,n=(i=this).getStep(this._current),!1===t&&null!=n.onNext){if(rslt=n.onNext(this),!1===rslt)return this._debug("onNext callback returned false, preventing move to next step"),this.showStep(this._current);e=this._makePromise(rslt)}return this._callOnPromiseDone(e,o)},t.prototype._showPrevStep=function(t){var e,o,n,i;if(t=t||!1,o=function(t){return i.showStep(n.prev)},e=void 0,n=(i=this).getStep(this._current),!1===t&&null!=n.onPrev){if(rslt=n.onPrev(this),!1===rslt)return this._debug("onPrev callback returned false, preventing move to previous step"),this.showStep(this._current);e=this._makePromise(rslt)}return this._callOnPromiseDone(e,o)},t.prototype._debug=function(t){if(this._options.debug)return window.console.log("[ Bootstrap Tour: '"+this._options.name+"' ] "+t)},t.prototype._isRedirect=function(t,e,o){var n;return!(null==t||""===t||!("[object RegExp]"==={}.toString.call(t)&&!t.test(o.origin)||"[object String]"==={}.toString.call(t)&&this._isHostDifferent(t,o)))||(n=[o.pathname,o.search,o.hash].join(""),null!=e&&""!==e&&("[object RegExp]"==={}.toString.call(e)&&!e.test(n)||"[object String]"==={}.toString.call(e)&&this._isPathDifferent(e,n)))},t.prototype._isHostDifferent=function(t,e){switch({}.toString.call(t)){case"[object RegExp]":return!t.test(e.origin);case"[object String]":return this._getProtocol(t)!==this._getProtocol(e.href)||this._getHost(t)!==this._getHost(e.href);default:return!0}},t.prototype._isPathDifferent=function(t,e){return this._getPath(t)!==this._getPath(e)||!this._equal(this._getQuery(t),this._getQuery(e))||!this._equal(this._getHash(t),this._getHash(e))},t.prototype._isJustPathHashDifferent=function(t,e,o){var n;return(null==t||""===t||!this._isHostDifferent(t,o))&&(n=[o.pathname,o.search,o.hash].join(""),"[object String]"==={}.toString.call(e)&&this._getPath(e)===this._getPath(n)&&this._equal(this._getQuery(e),this._getQuery(n))&&!this._equal(this._getHash(e),this._getHash(n)))},t.prototype._redirect=function(t,e,o){var n;return b.isFunction(t.redirect)?t.redirect.call(this,o):(n="[object String]"==={}.toString.call(t.host)?""+t.host+o:o,this._debug("Redirect to "+n),this._getState("redirect_to")!==""+e?(this._setState("redirect_to",""+e),w.location.href=n):(this._debug("Error redirection loop to "+o),this._removeState("redirect_to"),null!=t.onRedirectError?t.onRedirectError(this):void 0))},t.prototype._isOrphan=function(t){return 1==t.orphan||null==t.element||!b(t.element).length||b(t.element).is(":hidden")&&"http://www.w3.org/2000/svg"!==b(t.element)[0].namespaceURI},t.prototype._isLast=function(){return this._current<this._options.steps.length-1},t.prototype._showPopoverAndOverlay=function(t){var e;if(this.getCurrentStepIndex()===t&&!this.ended())return(e=this.getStep(t)).backdrop&&this._showOverlayElements(e),this._fixBootstrapSelectPickerZindex(e),this._showPopover(e,t),null!=e.onShown&&e.onShown(this),this},t.prototype._showPopover=function(t,e){var o,n,i,r,s,a,p;if(i=this._isOrphan(t),0==b(w).find(".popover.tour-"+this._options.name+".tour-"+this._options.name+"-"+this.getCurrentStepIndex()).length){b(".tour-"+this._options.name).remove(),t.template=this._template(t,e),i&&(t.element="body",t.placement="top"),(o=b(t.element)).addClass("tour-"+this._options.name+"-element tour-"+this._options.name+"-"+e+"-element"),t.reflex&&!i&&b(t.reflexElement).addClass("tour-step-element-reflex").off(this._reflexEvent(t.reflex)+".tour-"+this._options.name).on(this._reflexEvent(t.reflex)+".tour-"+this._options.name,(p=this,function(){return p._isLast()?p.next():p.end()})),r=t.title,s=t.content,a=parseInt((e+1)/this.getStepCount()*100),t.showProgressBar&&(s="function"==typeof t.getProgressBarHTML?t.getProgressBarHTML(a)+s:'<div class="progress"><div class="progress-bar progress-bar-striped" role="progressbar" style="width: '+a+'%;"></div></div>'+s),t.showProgressText&&("function"==typeof t.getProgressTextHTML?r+=t.getProgressTextHTML(e,a,this.getStepCount()):("bootstrap3"==this._options.framework&&(r+='<span class="pull-right">'+(e+1)+"/"+this.getStepCount()+"</span>"),"bootstrap4"==this._options.framework&&(r+='<span class="float-right">'+(e+1)+"/"+this.getStepCount()+"</span>")));var l={placement:t.placement,trigger:"manual",title:r,content:s,html:!0,whiteList:this._options.sanitizeWhitelist,sanitizeFn:this._options.sanitizeFunction,animation:t.animation,container:t.container,template:t.template,selector:t.element};"bootstrap4"==this._options.framework&&(i?l.offset=function(t){var e=Math.max(0,(b(window).height()-t.popper.height)/2),o=Math.max(0,(b(window).width()-t.popper.width)/2);return t.popper.position="fixed",t.popper.top=e,t.popper.bottom=e+t.popper.height,t.popper.left=o,t.popper.right=e+t.popper.width,t}:l.selector="#"+t.element[0].id),"bootstrap4"==this._options.framework&&0==i&&(l.selector="#"+t.element[0].id),o.popover(l),o.popover("show"),"bootstrap3"==this._options.framework&&(n=o.data("bs.popover")?o.data("bs.popover").tip():o.data("popover").tip(),"fixed"===o.css("position")&&n.css("position","fixed"),i?(this._center(n),n.css("position","fixed")):this._reposition(n,t)),"bootstrap4"==this._options.framework&&(n=b(o.data("bs.popover")?o.data("bs.popover").getTipElement():o.data("popover").getTipElement())),n.attr("id",t.id),this._debug("Step "+(this._current+1)+" of "+this._options.steps.length)}},t.prototype._template=function(t,e){var o,n,i,r,s,a;return a=t.template,this._isOrphan(t)&&"[object Boolean]"!=={}.toString.call(t.orphan)&&(a=t.orphan),i=(o=(s=b.isFunction(a)?b(a(e,t)):b(a)).find(".popover-navigation")).find('[data-role="prev"]'),n=o.find('[data-role="next"]'),r=o.find('[data-role="pause-resume"]'),this._isOrphan(t)&&s.addClass("orphan"),s.addClass("tour-"+this._options.name+" tour-"+this._options.name+"-"+e),t.reflex&&s.addClass("tour-"+this._options.name+"-reflex"),t.prev<0&&i.addClass("disabled").prop("disabled",!0).prop("tabindex",-1),t.next<0&&n.addClass("disabled").prop("disabled",!0).prop("tabindex",-1),t.reflexOnly&&n.hide(),t.duration||r.remove(),s.clone().wrap("<div>").parent().html()},t.prototype._reflexEvent=function(t){return"[object Boolean]"==={}.toString.call(t)?"click":t},t.prototype._reposition=function(t,e){var o,n,i,r,s,a,p;if(r=t[0].offsetWidth,n=t[0].offsetHeight,s=(p=t.offset()).left,a=p.top,(o=b(w).height()-p.top-t.outerHeight())<0&&(p.top=p.top+o),(i=b("html").outerWidth()-p.left-t.outerWidth())<0&&(p.left=p.left+i),p.top<0&&(p.top=0),p.left<0&&(p.left=0),t.offset(p),"bottom"===e.placement||"top"===e.placement){if(s!==p.left)return this._replaceArrow(t,2*(p.left-s),r,"left")}else if(a!==p.top)return this._replaceArrow(t,2*(p.top-a),n,"top")},t.prototype._center=function(t){return t.css("top",b(window).outerHeight()/2-t.outerHeight()/2),t.css("left",b(window).outerWidth()/2-t.outerWidth()/2)},t.prototype._replaceArrow=function(t,e,o,n){return t.find(".arrow").css(n,e?50*(1-e/o)+"%":"")},t.prototype._scrollIntoView=function(t){var e,o,n,i,r,s,a,p,l;if(a=this.getStep(t),e=b(a.element),this._isOrphan(a))return this._showPopoverAndOverlay(t);if(!e.length)return this._showPopoverAndOverlay(t);switch(o=b(window),r=e.offset().top,i=e.outerHeight(),p=o.height(),s=0,a.placement){case"top":s=Math.max(0,r-p/2);break;case"left":case"right":s=Math.max(0,r+i/2-p/2);break;case"bottom":s=Math.max(0,r+i-p/2)}return this._debug("Scroll into view. ScrollTop: "+s+". Element offset: "+r+". Window height: "+p+"."),n=0,b("body, html").stop(!0,!0).animate({scrollTop:Math.ceil(s)},(l=this,function(){if(2==++n)return l._showPopoverAndOverlay(t),l._debug("Scroll into view.\nAnimation end element offset: "+e.offset().top+".\nWindow height: "+o.height()+".")}))},t.prototype._onScroll=function(t,e){return b(window).on("scroll.tour-"+this._options.name,function(){return clearTimeout(e),e=setTimeout(t,100)})},t.prototype._initMouseNavigation=function(){var o,e,n,i;return o=this,b(w).off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']").off("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']").on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='next']",(i=this,function(t){return t.preventDefault(),i.next()})).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='prev']",(n=this,function(t){if(t.preventDefault(),0<n._current)return n.prev()})).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='end']",(e=this,function(t){return t.preventDefault(),e.end()})).on("click.tour-"+this._options.name,".popover.tour-"+this._options.name+" *[data-role='pause-resume']",function(t){var e;return t.preventDefault(),(e=b(this)).text(o._paused?e.data("pause-text"):e.data("resume-text")),o._paused?o.resume():o.pause()})},t.prototype._initKeyboardNavigation=function(){var e;if(this._options.keyboard)return b(w).on("keyup.tour-"+this._options.name,(e=this,function(t){if(t.which)switch(t.which){case 39:return t.preventDefault(),e._isLast()?e.next():e.end();case 37:if(t.preventDefault(),0<e._current)return e.prev()}}))},t.prototype._makePromise=function(t){return t&&b.isFunction(t.then)?t:null},t.prototype._callOnPromiseDone=function(t,e,o){return t?t.then((n=this,function(t){return e.call(n,o)})):e.call(this,o);var n},t.prototype._fixBootstrapSelectPickerZindex=function(t){var e;this._isOrphan(t)||0==b(w).find(".popover.tour-"+this._options.name+".tour-"+this._options.name+"-"+this.getCurrentStepIndex()).length&&0<(e="select"==b(t.element)[0].tagName.toLowerCase()?b(t.element):b(t.element).find("select:first")).length&&e.parent().hasClass("bootstrap-select")&&(this._debug("Fixing Bootstrap SelectPicker"),e.parent().css("z-index","1101"),this._setStepFlag(this.getCurrentStepIndex(),"elementBootstrapSelectpicker",e))},t.prototype._unfixBootstrapSelectPickerZindex=function(t){var e=this._getStepFlag(this.getCurrentStepIndex(),"elementBootstrapSelectpicker");e&&(this._debug("Unfixing Bootstrap SelectPicker"),e.parent().css("z-index","auto"))},t.prototype._showOverlayElements=function(t){var e,o;if(0==b(w).find(".popover.tour-"+this._options.name+".tour-"+this._options.name+"-"+this.getCurrentStepIndex()).length)if(o=!1,t.preventInteraction&&!o&&(b(t.backdropContainer).append("<div class='tour-prevent' id='tourPrevent'></div>"),b("#tourPrevent").width(b(t.element).outerWidth()),b("#tourPrevent").height(b(t.element).outerHeight()),b("#tourPrevent").offset(b(t.element).offset())),docHeight=b(w).height(),docWidth=b(w).width(),0===b(t.element).length||this._isOrphan(t)){var n=b('<div class="tour-backdrop tour-backdrop-orphan"></div>');n.offset({top:0,left:0}),n.width(docWidth),n.height(docHeight),b("body").append(n)}else{e={width:b(t.element).innerWidth(),height:b(t.element).innerHeight(),offset:b(t.element).offset()},t.backdropPadding&&(e=this._applyBackdropPadding(t.backdropPadding,e));var i=b('<div class="tour-backdrop top"></div>');i.offset({top:0,left:0}),i.width(docWidth),i.height(e.offset.top);var r=b('<div class="tour-backdrop left"></div>');r.width(e.offset.left),r.height(e.height),r.offset({top:e.offset.top,left:0});var s=b('<div class="tour-backdrop right"></div>');s.width(docWidth-(e.width+e.offset.left)),s.height(e.height),s.offset({top:e.offset.top,left:e.offset.left+e.width});var a=b('<div class="tour-backdrop bottom"></div>');a.width(docWidth),a.height(docHeight-e.offset.top-e.height),a.offset({top:e.offset.top+e.height,left:0}),b(t.backdropContainer).append(i),b(t.backdropContainer).append(r),b(t.backdropContainer).append(s),b(t.backdropContainer).append(a)}else o=!0},t.prototype._hideOverlayElement=function(t){b("#tourPrevent").length&&b("#tourPrevent").remove(),b(".tour-backdrop").remove()},t.prototype._applyBackdropPadding=function(t,e){return"object"==typeof t?(null==t.top&&(t.top=0),null==t.right&&(t.right=0),null==t.bottom&&(t.bottom=0),null==t.left&&(t.left=0),e.offset.top=e.offset.top-t.top,e.offset.left=e.offset.left-t.left,e.width=e.width+t.left+t.right,e.height=e.height+t.top+t.bottom):(e.offset.top=e.offset.top-t,e.offset.left=e.offset.left-t,e.width=e.width+2*t,e.height=e.height+2*t),e},t.prototype._clearTimer=function(){return window.clearTimeout(this._timer),this._timer=null,this._duration=null},t.prototype._getProtocol=function(t){return 1<(t=t.split("://")).length?t[0]:"http"},t.prototype._getHost=function(t){return(t=1<(t=t.split("//")).length?t[1]:t[0]).split("/")[0]},t.prototype._getPath=function(t){return t.replace(/\/?$/,"").split("?")[0].split("#")[0]},t.prototype._getQuery=function(t){return this._getParams(t,"?")},t.prototype._getHash=function(t){return this._getParams(t,"#")},t.prototype._getParams=function(t,e){var o,n,i,r,s;if(1===(r=t.split(e)).length)return{};for(s={},o=0,n=(r=r[1].split("&")).length;o<n;o++)s[(i=(i=r[o]).split("="))[0]]=i[1]||"";return s},t.prototype._equal=function(t,e){var o,n,i,r,s,a;if("[object Object]"==={}.toString.call(t)&&"[object Object]"==={}.toString.call(e)){if(r=Object.keys(t),s=Object.keys(e),r.length!==s.length)return!1;for(n in t)if(a=t[n],!this._equal(e[n],a))return!1;return!0}if("[object Array]"!=={}.toString.call(t)||"[object Array]"!=={}.toString.call(e))return t===e;if(t.length!==e.length)return!1;for(n=o=0,i=t.length;o<i;n=++o)if(a=t[n],!this._equal(a,e[n]))return!1;return!0},t});